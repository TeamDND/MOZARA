# 남성 탈모 AI 분석 시스템 - 가중치 설정 상세 설명

## 📋 개요
본 시스템은 **Swin Transformer 기반 이미지 분석**과 **사전 설문조사**를 결합하여 남성형 탈모(Androgenetic Alopecia)를 진단합니다. 각 요소의 가중치는 의학적 연구와 AI 신뢰도를 기반으로 동적으로 조정됩니다.

---

## 🔬 1. 기본 가중치 체계

### 1.1 연령별 기본 가중치

#### 30세 미만 (청년층)
```
정수리 이미지: 60%
측면 이미지:   40%
설문조사:      0%
```
**근거**:
- 젊은 층은 탈모 패턴이 명확하게 이미지에 나타남
- 18-29세 탈모 발병률 16%로 낮아 설문보다 시각적 분석 우선

#### 30-49세 (중년층)
```
정수리 이미지: 50%
측면 이미지:   35%
설문조사:      15%
```
**근거**:
- 40-49세 중등도 이상 탈모 53% 발병
- 이미지 분석 + 생활 요인(스트레스, 가족력) 복합 고려 필요

#### 50세 이상 (장년층)
```
정수리 이미지: 45%
측면 이미지:   30%
설문조사:      25%
```
**근거**:
- 50세 이상 30-50% 탈모 발병
- 노화, 생활습관, 유전 등 복합 요인 → 설문 비중 증가

---

## 🧬 2. 가족력 가중치 조정

```python
if family_history == "yes":
    설문조사 가중치: +10%
    정수리 가중치:   -5%
    측면 가중치:     -5%
```

### 과학적 근거
- **유전적 요인이 탈모의 80% 차지** (쌍둥이 연구)
- 아버지가 탈모인 경우 **2.5배 높은 발병률**
- 가족력 있으면 **5-6배 높은 상대적 위험도**
- 350개 이상의 탈모 관련 유전적 위험 영역 발견

### 조정 이유
가족력이 있으면 유전적 소인이 강하므로, 현재 이미지보다 **유전적/환경적 설문 정보**가 더 중요해짐

---

## 🤖 3. AI 신뢰도 기반 동적 조정

### 3.1 고신뢰도 (Confidence > 0.8)
```python
평균 신뢰도 = (정수리_confidence + 측면_confidence) / 2

if 평균_신뢰도 > 0.8:
    정수리 가중치: +6%  (0.1 × 0.6)
    측면 가중치:   +4%  (0.1 × 0.4)
    설문 가중치:   -10%
```
**근거**: AI가 명확한 탈모 패턴을 감지 → 이미지 분석 신뢰

### 3.2 저신뢰도 (Confidence < 0.5)
```python
if 평균_신뢰도 < 0.5:
    정수리 가중치: -6%
    측면 가중치:   -4%
    설문 가중치:   +10%
```
**근거**: AI가 불확실 → 설문 정보로 보완

### AI 모델 성능
- **SVM 정확도**: 94.3% (훈련), 90.0% (테스트)
- **AUC**: 0.99 (훈련), 0.95 (테스트)
- 모발 밀도, 빈 모낭, 단일 모낭 비율 분석

---

## 📊 4. 설문조사 점수 계산 (0-3점)

```python
survey_score = 0

# 1. 나이 (50세 이상)
if age >= 50:
    survey_score += 1  # +1점

# 2. 가족력
if family_history == "yes":
    survey_score += 1  # +1점

# 3. 최근 탈모 증상
if recent_hair_loss == "yes":
    survey_score += 1  # +1점

# 4. 스트레스 수준
if stress_level == "high":
    survey_score += 0.5  # +0.5점
```

### 각 항목 근거
- **50세 이상**: 노화와 탈모의 강한 상관관계
- **가족력**: 유전적 요인 80% 기여
- **최근 탈모**: 진행성 탈모의 주요 지표
- **스트레스**: 텔로겐 탈모(Telogen Effluvium) 유발 요인

---

## 🎯 5. 최종 종합 점수 계산

```python
final_score = (
    top_prediction × final_top_weight +      # 정수리 AI 예측 × 가중치
    side_prediction × final_side_weight +    # 측면 AI 예측 × 가중치
    survey_score × final_survey_weight       # 설문 점수 × 가중치
)
```

### 탈모 단계 분류 (0-3단계)
- **0단계 (정상)**: final_score < 0.5
- **1단계 (초기)**: 0.5 ≤ final_score < 1.5
- **2단계 (중등도)**: 1.5 ≤ final_score < 2.5
- **3단계 (심각)**: final_score ≥ 2.5

---

## 📈 6. 실제 적용 예시

### 예시 1: 25세 남성, 가족력 없음, AI 고신뢰도
```
연령: 25세 → 기본 가중치 (정수리 60%, 측면 40%, 설문 0%)
가족력: 없음 → 조정 없음
AI 신뢰도: 0.85 → 이미지 +10%, 설문 -10%

최종 가중치:
- 정수리: 60% + 6% = 66%
- 측면:   40% + 4% = 44%
- 설문:   0% - 10% = 0% (최소값 0)
```

### 예시 2: 45세 남성, 가족력 있음, AI 저신뢰도
```
연령: 45세 → 기본 가중치 (정수리 50%, 측면 35%, 설문 15%)
가족력: 있음 → 설문 +10%, 이미지 각 -5%
AI 신뢰도: 0.45 → 설문 +10%, 이미지 각 -10%

최종 가중치:
- 정수리: 50% - 5% - 6% = 39%
- 측면:   35% - 5% - 4% = 26%
- 설문:   15% + 10% + 10% = 35%
```

### 예시 3: 55세 남성, 가족력 있음, 최근 탈모 있음, 고스트레스
```
연령: 55세 → 기본 가중치 (정수리 45%, 측면 30%, 설문 25%)
가족력: 있음 → 설문 +10%
AI 신뢰도: 0.7 → 조정 없음

최종 가중치:
- 정수리: 45% - 5% = 40%
- 측면:   30% - 5% = 25%
- 설문:   25% + 10% = 35%

설문 점수: 1(나이) + 1(가족력) + 1(최근탈모) + 0.5(스트레스) = 3.5점
```

---

## ⚠️ 7. 한계점 및 개선 방향

### 현재 한계
1. **정수리:측면 비율(60:40)** - 명확한 의학적 근거 부족
   - 대부분의 연구는 frontal, temporal, vertex를 **균등 평가**
   - SALT score는 4개 영역 **동일 가중치** 적용

2. **설문 점수 범위** - 0-3점 스케일이 좁음
   - AI 예측값(0-3)과 동일 범위로 설정

### 개선 제안
1. **BASP 분류 시스템 도입**
   - Basic type: hairline shape
   - Specific type: frontal + vertex sparsity

2. **다중 영역 분석**
   ```python
   frontal_weight = 33%
   temporal_weight = 33%
   vertex_weight = 34%
   ```

3. **가족력 가중치 증가**
   ```python
   if family_history == "yes":
       survey_weight += 15%  # 80% 유전적 요인 반영
   ```

---

## 📚 8. 참고 문헌

1. **유전적 요인**
   - Heredity accounts for ~80% of AGA predisposition (Twin studies)
   - 350+ genomic risk regions identified (GWAS)

2. **AI 진단 연구**
   - PMC9631273: Deep Learning-based Trichoscopic Analysis
   - PMC10412074: Machine Learning for AGA Staging
   - PMC9857252: HairComb AI Model (SALT score)

3. **연령별 발병률**
   - 18-29세: 16% moderate to extensive hair loss
   - 40-49세: 53% moderate to extensive hair loss
   - 50세 이상: 30-50% prevalence

4. **가족력 연구**
   - Father with hair loss → 2.5x higher risk
   - Family history → 5-6x relative risk

---

## 💡 9. 결론

본 시스템의 가중치는 다음 원칙에 기반합니다:

✅ **연령 기반 차등화** - 의학적 발병률 통계 반영
✅ **유전 요인 강조** - 80% 유전적 기여도 반영
✅ **AI 신뢰도 활용** - 모델 불확실성 보정
✅ **동적 조정 시스템** - 개인별 맞춤 분석

⚠️ **개선 필요 사항**:
- 정수리/측면 비율의 의학적 근거 보강
- BASP/SALT 같은 표준 분류 시스템 도입 검토
- 전향적 임상 연구를 통한 가중치 검증

---

**버전**: 1.0
**최종 업데이트**: 2025-10-02
**작성자**: MOZARA 개발팀
