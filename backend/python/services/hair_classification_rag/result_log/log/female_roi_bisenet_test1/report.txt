================================================================================
Female Hair Loss - BiSeNet ROI-based Confidence-Weighted Ensemble - Test #1
================================================================================
테스트 일시: 2025-10-01 12:51:16
테스트 데이터: C:\Users\301\Desktop\female_classification\test\selected_test
대상 스테이지: Stage 1-5 (총 5개 클래스)
인덱스: ConvNeXt='hair-loss-rag-analyzer', ViT='hair-loss-vit-s16'
파라미터: top_k=10, Tconv=0.15, Tvit=0.2
앙상블 방식: 신뢰도 기반 동적 가중치 (Confidence-Weighted)
ROI 추출: BiSeNet 세그멘테이션
필터: gender=female, embedding_type=roi

📊 전체 결과
----------------------------------------
총 테스트 수: 100
정확도 (Accuracy): 0.140
정밀도 (Precision): 0.155
재현율 (Recall): 0.140
F1-Score: 0.125
총 소요 시간: 512.73초
이미지당 평균 시간: 5127.3ms

📁 스테이지별 테스트 파일 수
----------------------------------------
Stage 1: 20개 파일
Stage 2: 20개 파일
Stage 3: 20개 파일
Stage 4: 20개 파일
Stage 5: 20개 파일

🎯 클래스별 성능 (Stage 1-5)
----------------------------------------
Stage 1: 정밀도=0.137, 재현율=0.350, F1=0.197, Support=20.0
Stage 2: 정밀도=0.133, 재현율=0.100, F1=0.114, Support=20.0
Stage 3: 정밀도=0.200, 재현율=0.050, F1=0.080, Support=20.0
Stage 4: 정밀도=0.105, 재현율=0.100, F1=0.103, Support=20.0
Stage 5: 정밀도=0.200, 재현율=0.100, F1=0.133, Support=20.0

⏱️ 단계별 처리 시간 통계 (밀리초)
----------------------------------------
Step                      Mean       Std        Min        Max       
----------------------------------------
Image Loading             1.51       3.04       0.56       31.26     
BiSeNet Segmentation      2.93       0.97       1.31       5.75      
ROI ViT Embedding         1061.28    861.34     32.06      3708.54   
ROI ConvNeXt Embedding    3599.50    2040.52    695.99     9058.82   
ROI ViT Search            226.93     66.87      211.73     890.52    
ROI ConvNeXt Search       234.71     85.41      213.30     1059.99   
KNN Probability           0.28       0.11       0.10       0.93      
Ensemble                  0.09       0.05       0.03       0.34      
----------------------------------------
Total Pipeline            5127.23   

⚖️ 신뢰도 기반 동적 가중치 정보
----------------------------------------
방식: 각 모델의 최대 확률값을 신뢰도로 사용하여 동적 가중치 계산
공식: w_model = conf_model / (conf_conv + conf_vit)

평균 ConvNeXt 가중치: 0.316
평균 ViT 가중치: 0.684
평균 ConvNeXt 신뢰도: 0.469
평균 ViT 신뢰도: 1.000

🔬 BiSeNet ROI 방식의 특징
----------------------------------------
✓ BiSeNet으로 두피 영역만 정확히 추출
✓ 배경/얼굴 등 노이즈 제거
✓ ROI embedding DB와 비교하여 정확도 향상
✓ 두피 특화 특징 학습 가능

💡 장점
----------------------------------------
✓ Per-class 가중치 최적화 불필요 (시간 절약)
✓ 이미지별 동적 가중치 조정
✓ 더 확신하는 모델에 자동으로 높은 가중치 부여
✓ ROI 기반으로 탈모 영역에만 집중
✓ 간단한 구현으로 안정적인 성능
