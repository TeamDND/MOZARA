================================================================================
ConvNeXt+ViT 듀얼 이미지 Middle Fusion 테스트 - Test #1
================================================================================
테스트 일시: 2025-09-25 13:50:26
테스트 데이터: C:\Users\301\Desktop\top_down_side_test
융합 방식: Middle Fusion (적응적 가중치)
인덱스: ConvNeXt='hair-loss-rag-analyzer', ViT='hair-loss-vit-s16'
파라미터: top_k=10, Tconv=0.15, Tvit=0.2, override=True

📊 전체 결과
----------------------------------------
총 듀얼 페어 수: 3
정확도 (Accuracy): 0.333
정밀도 (Precision): 0.667
재현율 (Recall): 0.333
F1-Score: 0.444

📁 레벨별 듀얼 페어 수
----------------------------------------
레벨 2: 2개 페어
레벨 3: 1개 페어

📐 뷰포인트 조합별 통계
----------------------------------------
front+left: 0/1 (0.000)
front+right: 1/1 (1.000)
top-down+left: 0/1 (0.000)

👤 인원별 상세 결과 (Middle Fusion 가중치)
----------------------------------------
 1. 인원1 ✗
    정답: Level 2 | 예측: Level 1
    Primary: 1-Top-Down_jpg.rf.0e66e06d513256dad94cdf8584cdfd74.jpg (top-down)
    Secondary: 1-Left_jpg.rf.6bc2f4b4c055fe1c23be4d36a8b8f6ef.jpg (left)
    총 이미지: 2장
    Fusion 가중치:
      ConvNeXt: 0.60(top-down) + 0.40(left)
      ViT: 0.40(top-down) + 0.60(left)
      적응적 가중치: True
    예측 확률: L1(0.341) L2(0.292) L4(0.244) 

 2. 인원17 ✓
    정답: Level 2 | 예측: Level 2
    Primary: 17-Front_jpg.rf.09d799a68cabda5c5cea7137eb29d1dd.jpg (front)
    Secondary: 17-Right_jpg.rf.782c2bb91f35e43fb8eaf052b5574d8a.jpg (right)
    총 이미지: 2장
    Fusion 가중치:
      ConvNeXt: 0.40(front) + 0.60(right)
      ViT: 0.60(front) + 0.40(right)
      적응적 가중치: True
    예측 확률: L2(0.616) L3(0.163) L4(0.155) 

 3. 인원23 ✗
    정답: Level 3 | 예측: Level 5
    Primary: 23-Front_jpg.rf.277f2482ced851f66f9916b9f3bf244e.jpg (front)
    Secondary: 23-Left_jpg.rf.53456665e57a2bb799e3deaab1f38340.jpg (left)
    총 이미지: 2장
    Fusion 가중치:
      ConvNeXt: 0.40(front) + 0.60(left)
      ViT: 0.60(front) + 0.40(left)
      적응적 가중치: True
    예측 확률: L5(0.324) L3(0.201) L2(0.177) 

🚨 2단계 이상 편차 분석
----------------------------------------
총 큰 편차 케이스: 1개
전체 페어 대비 비율: 33.3%

편차별 발생 건수:
  2단계 편차: 1건

뷰포인트 조합별 큰 편차 발생:
  front+left: 1건

큰 편차 케이스 상세 (Middle Fusion 가중치 포함):
  1. 인원23 | 정답:L3 → 예측:L5 (편차:2)
      front+left | 23-Front_jpg.rf.277f2482ced851f66f9916b9f3bf244e.jpg, 23-Left_jpg.rf.53456665e57a2bb799e3deaab1f38340.jpg
      가중치 - Conv: 0.40/0.60, ViT: 0.60/0.40

🔍 Middle Fusion 큰 편차 발생 원인 분석:
  - 적응적 가중치의 한계: 개별 이미지 품질 차이 미반영
  - 모델별 융합 효과: ConvNeXt/ViT의 뷰포인트별 특성 차이
  - 앙상블 단계 영향: 융합된 확률에 per-class 가중치 적용
  - 뷰포인트 조합 최적화 필요: 특정 조합에서 가중치 조정 요구

📊 4단계 노우드 분류 성능
----------------------------------------
4단계 정확도: 0.333
4단계 정밀도: 1.000
4단계 재현율: 0.333
4단계 F1-Score: 0.500

4단계별 상세 성능:
  0단계(Lv1): 정밀도=0.000, 재현율=0.000, F1=0.000
  1단계(Lv2-3): 정밀도=1.000, 재현율=0.333, F1=0.500
  2단계(Lv4-5): 정밀도=0.000, 재현율=0.000, F1=0.000
  3단계(Lv6-7): 정밀도=0.000, 재현율=0.000, F1=0.000

🎯 7단계 클래스별 성능
----------------------------------------
레벨 1: 정밀도=0.000, 재현율=0.000, F1=0.000
레벨 2: 정밀도=1.000, 재현율=0.500, F1=0.667
레벨 3: 정밀도=0.000, 재현율=0.000, F1=0.000
레벨 4: 정밀도=0.000, 재현율=0.000, F1=0.000
레벨 5: 정밀도=0.000, 재현율=0.000, F1=0.000
레벨 6: 정밀도=0.000, 재현율=0.000, F1=0.000
레벨 7: 정밀도=0.000, 재현율=0.000, F1=0.000

🔄 Middle Fusion 가중치 전략
----------------------------------------
적응적 가중치 규칙:
  Top-down Primary: ConvNeXt 0.6, ViT 0.4 (지역적 패턴 강화)
  Front Primary: ConvNeXt 0.4, ViT 0.6 (글로벌 헤어라인 강화)
  Left/Right Secondary: ConvNeXt 0.6, ViT 0.4 (측면 패턴 강화)
  기타: ConvNeXt 0.5, ViT 0.5 (균등 가중치)

