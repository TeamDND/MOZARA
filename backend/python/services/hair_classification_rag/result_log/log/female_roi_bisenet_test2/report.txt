================================================================================
Female Hair Loss - BiSeNet ROI-based Confidence-Weighted Ensemble - Test #2
================================================================================
테스트 일시: 2025-10-01 15:31:17
테스트 데이터: C:\Users\301\Desktop\female_classification\test\selected_test
대상 스테이지: Stage 1-5 (총 5개 클래스)
인덱스: ConvNeXt='hair-loss-rag-analyzer', ViT='hair-loss-vit-s16'
파라미터: top_k=10, Tconv=0.15, Tvit=0.2
앙상블 방식: 신뢰도 기반 동적 가중치 (Confidence-Weighted)
ROI 추출: BiSeNet 세그멘테이션
필터: gender=female, embedding_type=roi

📊 전체 결과
----------------------------------------
총 테스트 수: 100
정확도 (Accuracy): 0.700
정밀도 (Precision): 0.756
재현율 (Recall): 0.700
F1-Score: 0.696
총 소요 시간: 133.86초
이미지당 평균 시간: 1338.6ms

📁 스테이지별 테스트 파일 수
----------------------------------------
Stage 1: 20개 파일
Stage 2: 20개 파일
Stage 3: 20개 파일
Stage 4: 20개 파일
Stage 5: 20개 파일

🎯 클래스별 성능 (Stage 1-5)
----------------------------------------
Stage 1: 정밀도=0.516, 재현율=0.800, F1=0.627, Support=20.0
Stage 2: 정밀도=0.654, 재현율=0.850, F1=0.739, Support=20.0
Stage 3: 정밀도=0.800, 재현율=0.400, F1=0.533, Support=20.0
Stage 4: 정밀도=1.000, 재현율=0.600, F1=0.750, Support=20.0
Stage 5: 정밀도=0.810, 재현율=0.850, F1=0.829, Support=20.0

⏱️ 단계별 처리 시간 통계 (밀리초)
----------------------------------------
Step                      Mean       Std        Min        Max       
----------------------------------------
Image Loading             0.51       0.67       0.18       6.73      
BiSeNet Segmentation      2.56       1.78       0.96       7.63      
ROI ViT Embedding         45.05      13.19      30.55      95.09     
ROI ConvNeXt Embedding    693.60     63.79      619.84     978.22    
ROI ViT Search            209.62     62.80      198.07     832.41    
ROI ConvNeXt Search       386.86     237.00     203.70     1016.27   
KNN Probability           0.28       0.14       0.10       0.74      
Ensemble                  0.08       0.05       0.03       0.23      
----------------------------------------
Total Pipeline            1338.54   

⚖️ 신뢰도 기반 동적 가중치 정보
----------------------------------------
방식: 각 모델의 최대 확률값을 신뢰도로 사용하여 동적 가중치 계산
공식: w_model = conf_model / (conf_conv + conf_vit)

평균 ConvNeXt 가중치: 0.426
평균 ViT 가중치: 0.574
평균 ConvNeXt 신뢰도: 0.482
평균 ViT 신뢰도: 0.668

🔬 BiSeNet ROI 방식의 특징
----------------------------------------
✓ BiSeNet으로 두피 영역만 정확히 추출
✓ 배경/얼굴 등 노이즈 제거
✓ ROI embedding DB와 비교하여 정확도 향상
✓ 두피 특화 특징 학습 가능

💡 장점
----------------------------------------
✓ Per-class 가중치 최적화 불필요 (시간 절약)
✓ 이미지별 동적 가중치 조정
✓ 더 확신하는 모델에 자동으로 높은 가중치 부여
✓ ROI 기반으로 탈모 영역에만 집중
✓ 간단한 구현으로 안정적인 성능
