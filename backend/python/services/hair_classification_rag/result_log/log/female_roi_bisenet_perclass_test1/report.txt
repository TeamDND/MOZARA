================================================================================
Female Hair Loss - BiSeNet ROI-based Per-Class Weighted Ensemble - Test #1
================================================================================
테스트 일시: 2025-10-01 17:41:43
테스트 데이터: C:\Users\301\Desktop\female_classification\test\selected_test
대상 스테이지: Stage 1-5 (총 5개 클래스)
인덱스: ConvNeXt='hair-loss-rag-analyzer', ViT='hair-loss-vit-s16'
파라미터: top_k=10, Tconv=0.15, Tvit=0.2
앙상블 방식: Per-Class 최적 가중치 (Full Embedding 최적화)
ROI 추출: BiSeNet 세그멘테이션
필터: gender=female, embedding_type=roi
가중치 설정: C:\Users\301\Desktop\main_project\backend\python\services\hair_classification_rag\result_log\tester\weight\weight(female_full+1)\ensemble_config.json

📊 전체 결과
----------------------------------------
총 테스트 수: 100
정확도 (Accuracy): 0.690
정밀도 (Precision): 0.759
재현율 (Recall): 0.690
F1-Score: 0.681
총 소요 시간: 131.91초
이미지당 평균 시간: 1319.1ms

📁 스테이지별 테스트 파일 수
----------------------------------------
Stage 1: 20개 파일
Stage 2: 20개 파일
Stage 3: 20개 파일
Stage 4: 20개 파일
Stage 5: 20개 파일

⚖️ Per-Class 최적 가중치
----------------------------------------
Stage 1: ConvNeXt=0.000, ViT=1.000 (F1=0.647)
Stage 2: ConvNeXt=0.250, ViT=0.750 (F1=0.679)
Stage 3: ConvNeXt=0.500, ViT=0.500 (F1=0.606)
Stage 4: ConvNeXt=0.500, ViT=0.500 (F1=0.780)
Stage 5: ConvNeXt=0.000, ViT=1.000 [ViT Strong, τ=0.70] (F1=0.837)

🎯 Override 통계
----------------------------------------
총 Override 적용: 14회 (14.0%)
  - ConvNeXt Override: 0회
  - ViT Override: 14회

🎯 클래스별 성능 (Stage 1-5)
----------------------------------------
Stage 1: 정밀도=0.652, 재현율=0.750, F1=0.698, Support=20.0
Stage 2: 정밀도=0.529, 재현율=0.900, F1=0.667, Support=20.0
Stage 3: 정밀도=0.875, 재현율=0.350, F1=0.500, Support=20.0
Stage 4: 정밀도=1.000, 재현율=0.600, F1=0.750, Support=20.0
Stage 5: 정밀도=0.739, 재현율=0.850, F1=0.791, Support=20.0

⏱️ 단계별 처리 시간 통계 (밀리초)
----------------------------------------
Step                      Mean       Std        Min        Max       
----------------------------------------
Image Loading             7.51       21.26      0.54       114.26    
BiSeNet Segmentation      5.54       14.45      1.21       114.73    
ROI ViT Embedding         56.76      14.61      32.04      122.38    
ROI ConvNeXt Embedding    830.06     130.91     598.31     1220.26   
ROI ViT Search            206.86     59.64      197.13     799.19    
ROI ConvNeXt Search       212.08     77.08      198.80     977.31    
KNN Probability           0.25       0.14       0.10       0.72      
Ensemble                  0.05       0.03       0.01       0.18      
----------------------------------------
Total Pipeline            1319.11   

🔬 Per-Class Weighted 방식의 특징
----------------------------------------
✓ BiSeNet으로 두피 영역만 정확히 추출
✓ 배경/얼굴 등 노이즈 제거
✓ ROI embedding DB와 비교하여 정확도 향상
✓ Full embedding 최적화 가중치를 ROI에 적용
✓ Stage별로 최적화된 고정 가중치 사용
✓ Override 로직으로 고신뢰도 예측 강화

💡 장점
----------------------------------------
✓ Full embedding으로 최적화된 가중치 활용
✓ Stage별 모델 강약점 반영
✓ ROI 기반으로 탈모 영역에만 집중
✓ Override 로직으로 확실한 경우 즉시 판단
✓ 안정적이고 재현 가능한 성능
